<app-header></app-header>
<!--第一个 jumbotron 用于铺个底-->
<div class="jumbotron" style="margin-bottom: auto; height: 100%; width: 100%; position: absolute"></div>
<div class="jumbotron" style="margin-bottom: auto; height: auto; width: 100%; position: absolute" align="center">
  <!--错误提示-->
  <div *ngIf="showMessage != null">
    <ngb-alert [dismissible]="false" type="danger" style="text-align: center">
      {{showMessage}}
    </ngb-alert>
  </div>
  <div class="col-8">
    <br><br>
    <div class="col-10">
      <p style="text-align: left; margin-top: 30px;"><strong>&nbsp;选择触发分支：</strong></p>
      <p style="text-align: left; margin-top: -15px" class="small">&nbsp;当代码仓库收到提交请求时，EasyCI 将自动触发构建</p>
      <hr>
      <div class="row">
        <div *ngFor="let branch of currentRepoBranches" style="margin-left: 20px">
          <input type="checkbox" id="{{branch}}" value="{{branch}}"
                 (click)="updateCheckedBranch($event.target.checked, $event.target.defaultValue)">
          <label for="{{branch}}">{{branch}}</label>
        </div>
      </div>
      <p style="text-align: left; margin-top: 30px"><strong>&nbsp;为 Flow 添加工作插件：</strong></p>
      <ol class="breadcrumb">
        <li style="line-height: 50px">O->
          <p class="btn btn-secondary">Git Clone</p>
        </li>
        <li style="line-height: 50px">--->
          <p class="btn btn-secondary">编译</p>
        </li>
        <div *ngFor="let plugin of currentPlugins">
          <li style="line-height: 50px">--->
            <p class="btn btn-primary">{{plugin.fullName}} &nbsp;
              <button class="btn btn-outline-dark btn-sm" style="padding: 0px;"
                      (click)="removeOneOnCurrentPlugins(plugin)">X
              </button>
            </p>
          </li>
        </div>
      </ol>
      <ol class="breadcrumb" style="margin-bottom: -5px;">
        <div *ngFor="let plugin of pluginsResponse.plugins">
          <li style="line-height: 50px;">&nbsp;&nbsp;
            <button class="btn btn-outline-primary" (click)="addOneOnCurrentPlugins(plugin)">{{plugin.fullName}}
            </button>
          </li>
        </div>
      </ol>
      <hr class="my-0">
      <p class="small">↑ 系统当前支持插件，点击添加到你的 Flow 中 ↑</p>
      <br>
      <p style="text-align: left"><strong>&nbsp;配置所需的环境变量：</strong></p>
      <div *ngFor="let plugin of currentPlugins">
        <div *ngFor="let pluginEnv of plugin.needEnv">
          <div class="input-group mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text">{{pluginEnv.envName}}</span>
            </div>
            <input #env type="text" class="form-control"
                   name="{{pluginEnv.envName}}" placeholder="{{pluginEnv.envDescription}}"
                   (blur)="updatePluginEnv(pluginEnv.envName, env.value)">
          </div>
        </div>
      </div>
      <hr class="my-0">
      <p class="small">↑ 当选择的插件需要配置环境变量时，他将显示在这里 ↑</p>
      <!--创建Flow，Loading提示-->
      <div *ngIf="creatingMessage != null">
        <ngb-alert [dismissible]="false" type="warning" style="text-align: center">
          <strong>{{creatingMessage}}</strong>
        </ngb-alert>
      </div>
      <div style="margin-top: 20px">
        <button class="btn btn-dark" (click)="goBack()">取消</button>
        <button class="btn btn-success" *ngIf="version != null" (click)="createFlow()">创建 Flow</button>
      </div>
    </div>
  </div>
</div>
